# 3.1 k近邻法

## 3.1 k近邻算法

内容：给定一个训练数据集，对新输入的实例，在训练数据集中找到与该实例最近邻的k的实例，这k个实例的多数属于某个类，就把该输入实例分为这个类。

<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220924103804387.png" alt="image-20220924103804387" style="zoom:67%;" />

算法3.1（k近邻法）

- 输入：训练数据集T
- 输出：实例x所属的类y

步骤：

1. 根据给定的距离量度，在训练集T中找出与x最近邻的k个点，涵盖这k个点的x的邻域记作:
   $$
   N_k(x)
   $$

2. 在N_k(x)中根据分类决策规则（如多数表决）决定x的类别y

k近邻法的特殊情况是k=1的情形，称为最近邻算法。对于输入的实例点（特征向量）x，最近邻法将训练数据集中与x最近邻的点的类作为x的类。

# 3.2 k近邻模型

k近邻法使用的模型实际上对应用于对特征空间的划分。模型由三个基本要素——距离量度、k值的选择和分类决策规则决定。

## 3.2.1 模型

特征空间中，对每个训练实例点xi，距离该点比其他点更近的所有点组成一个区域，叫做单元。
每个单元的实例点的类别是确定的。

## 3.2.2 距离量度

特征空间中两个实例点的距离是两个实例点相似程度的反映。k近邻模型的特征空间一般是n维实数向量空间R^n。

![img](https://pic1.zhimg.com/80/v2-60bb382b0d22ec0ce296ed0e024f31bc_1440w.png)

其中当p=2的时候，就是我们最常见的欧式距离，我们也一般都用欧式距离来衡量我们高维空间中俩点的距离。在实际应用中，距离函数的选择应该根据数据的特性和分析的需要而定，一般选取p=2欧式距离表示。

## 3.2.3 k值的选择

k值的选择会对k近邻法的结果产生重大影响。

<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220924104833941.png" alt="image-20220924104833941" style="zoom:67%;" />

<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20220924110138735.png" alt="image-20220924110138735" style="zoom:67%;" />

## 3.2.4 分类决策规则

一般采用多数表决，由输入实例的k个邻近的训练实例中的多数类决定输入实例的类。





# 3.3 k近邻法的实现：kd树

实现k近邻法时，主要考虑的问题是如何对训练数据进行快速k近邻搜索。

kd 树是一种二叉树数据结构，可以用来进行高效的 knn 计算。

先忽略在编程上的实现，想一想一个人如何主观地执行。嗯，他一定会把在五角附近的一些点中，分别计算每一个的距离，然后选最近的15个。这样可能只需要进行二三十次距离计算，而不是300次。
<img src="https://image.joinquant.com/5c24f8587890bff777195c32a20ae4be" alt="2.png" style="zoom:67%;" />

如图，只对紫圈里的点进行计算。

啊哈！问题来了。我们讲到的“附近”已经包含了距离的概念，如果不经过计算我们怎么知道哪个点是在五角星的“附近”？为什么我们一下就认出了“附近”而计算机做不到？那是因为我们在观看这张图片时，得到的输入是已经带有距离概念的影像，然而计算机在进行计算时得到的则是没有距离概念的坐标数据。如果要让一个人人为地从300组坐标里选出最近的15个，而不给他图像，那么他也省不了功夫，必须要把300个全部计算一遍才行。

这样来说，我们要做的就是在干巴巴的坐标数据上进行加工，<u>**将空间分割成小块**</u>，并以合理地方法将信息进行储存，这样方便我们读取“附近”的点。

构造kd树相当于不断用垂直于坐标轴的超平面将k维空间切分，构成一系列的k维超矩形区域。kd树的每个节点对应于一个k维超矩形区域。

算法3.2 构造平衡kd树

- 输入：k维空间数据集T
  $$
  T=\{x_1,x_2,...,x_N\},其中x_i=\{x_{i}^{(1)},x_{i}^{(2)},...,x_{i}^{(k)}\}^{T},i=1,2,...N;
  $$

- 输出：kd树

- 

















------

参考内容：

[【数学】kd 树算法之详细篇 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/23966698)

[【量化课堂】kd 树算法之思路篇 - JoinQuant量化课堂 - JoinQuant](https://www.joinquant.com/view/community/detail/dd60bd4e89761b916fe36dc4d14bb272)











